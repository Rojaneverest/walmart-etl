[2025-05-27T22:11:37.037+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: synthetic_data_generation.generate_supplier_data manual__2025-05-27T22:11:35.673321+00:00 [queued]>
[2025-05-27T22:11:37.045+0000] {taskinstance.py:1159} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: synthetic_data_generation.generate_supplier_data manual__2025-05-27T22:11:35.673321+00:00 [queued]>
[2025-05-27T22:11:37.045+0000] {taskinstance.py:1361} INFO - Starting attempt 1 of 2
[2025-05-27T22:11:37.053+0000] {taskinstance.py:1382} INFO - Executing <Task(PythonOperator): generate_supplier_data> on 2025-05-27 22:11:35.673321+00:00
[2025-05-27T22:11:37.065+0000] {standard_task_runner.py:57} INFO - Started process 134 to run task
[2025-05-27T22:11:37.076+0000] {standard_task_runner.py:84} INFO - Running: ['***', 'tasks', 'run', 'synthetic_data_generation', 'generate_supplier_data', 'manual__2025-05-27T22:11:35.673321+00:00', '--job-id', '438', '--raw', '--subdir', 'DAGS_FOLDER/synthetic_data_dag.py', '--cfg-path', '/tmp/tmpsxa7h7wl']
[2025-05-27T22:11:37.082+0000] {standard_task_runner.py:85} INFO - Job 438: Subtask generate_supplier_data
[2025-05-27T22:11:37.131+0000] {task_command.py:416} INFO - Running <TaskInstance: synthetic_data_generation.generate_supplier_data manual__2025-05-27T22:11:35.673321+00:00 [running]> on host e2de720f118d
[2025-05-27T22:11:37.575+0000] {taskinstance.py:1662} INFO - Exporting env vars: AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='synthetic_data_generation' AIRFLOW_CTX_TASK_ID='generate_supplier_data' AIRFLOW_CTX_EXECUTION_DATE='2025-05-27T22:11:35.673321+00:00' AIRFLOW_CTX_TRY_NUMBER='1' AIRFLOW_CTX_DAG_RUN_ID='manual__2025-05-27T22:11:35.673321+00:00'
[2025-05-27T22:11:37.577+0000] {logging_mixin.py:154} INFO - Generating supplier data...
[2025-05-27T22:11:37.618+0000] {taskinstance.py:1937} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/airflow/.local/lib/python3.8/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
psycopg2.errors.StringDataRightTruncation: value too long for type character varying(20)


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 192, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 209, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/walmart-etl/generate_synthetic_data.py", line 103, in generate_supplier_data
    df_suppliers.to_sql('ods_supplier', engine, if_exists='append', index=False)
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/core/generic.py", line 2878, in to_sql
    return sql.to_sql(
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/io/sql.py", line 769, in to_sql
    return pandas_sql.to_sql(
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/io/sql.py", line 1920, in to_sql
    total_inserted = sql_engine.insert_records(
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/io/sql.py", line 1470, in insert_records
    raise err
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/io/sql.py", line 1461, in insert_records
    return table.insert(chunksize=chunksize, method=method)
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/io/sql.py", line 1023, in insert
    num_inserted = exec_insert(conn, keys, chunk_iter)
  File "/home/airflow/.local/lib/python3.8/site-packages/pandas/io/sql.py", line 929, in _execute_insert
    result = conn.execute(self.table.insert(), data)
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1385, in execute
    return meth(self, multiparams, params, _EMPTY_EXECUTION_OPTS)
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/sql/elements.py", line 334, in _execute_on_connection
    return connection._execute_clauseelement(
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1577, in _execute_clauseelement
    ret = self._execute_context(
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1953, in _execute_context
    self._handle_dbapi_exception(
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 2134, in _handle_dbapi_exception
    util.raise_(
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/util/compat.py", line 211, in raise_
    raise exception
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/engine/base.py", line 1890, in _execute_context
    self.dialect.do_executemany(
  File "/home/airflow/.local/lib/python3.8/site-packages/sqlalchemy/dialects/postgresql/psycopg2.py", line 982, in do_executemany
    context._psycopg2_fetched_rows = xtras.execute_values(
  File "/home/airflow/.local/lib/python3.8/site-packages/psycopg2/extras.py", line 1299, in execute_values
    cur.execute(b''.join(parts))
sqlalchemy.exc.DataError: (psycopg2.errors.StringDataRightTruncation) value too long for type character varying(20)

[SQL: INSERT INTO ods_supplier (supplier_id, supplier_name, contact_person, email, phone, address, city, state, zip_code, contract_start_date, source_system, load_timestamp) VALUES (%(supplier_id)s, %(supplier_name)s, %(contact_person)s, %(email)s, %(phone)s, %(address)s, %(city)s, %(state)s, %(zip_code)s, %(contract_start_date)s, %(source_system)s, %(load_timestamp)s)]
[parameters: ({'supplier_id': '24a17ebd-a799-41c6-9a97-a3b8b7b7c4a7', 'supplier_name': 'Premier Products Corp', 'contact_person': 'Mike Jones', 'email': 'mike.jones@premierproductscorp.com', 'phone': '+1-815-876-4999', 'address': '8322 Main St, Suite 536', 'city': 'Phoenix', 'state': 'Florida', 'zip_code': '85784', 'contract_start_date': datetime.datetime(2012, 3, 25, 0, 0), 'source_system': 'Synthetic Data', 'load_timestamp': datetime.datetime(2025, 5, 27, 22, 11, 37, 588482)}, {'supplier_id': 'e2d5ce8e-525c-4af8-a5cb-b106d77eb45f', 'supplier_name': 'Global Logistics Enterprises', 'contact_person': 'Mike Smith', 'email': 'mike.smith@globallogisticsenterprises.com', 'phone': '+1-325-777-4233', 'address': '2200 Main St, Suite 969', 'city': 'San Diego', 'state': 'Ohio', 'zip_code': '45585', 'contract_start_date': datetime.datetime(2010, 1, 8, 0, 0), 'source_system': 'Synthetic Data', 'load_timestamp': datetime.datetime(2025, 5, 27, 22, 11, 37, 588520)}, {'supplier_id': '38fad1dd-67e0-4cb1-b408-ab103fb25da2', 'supplier_name': 'Quality Retail LLC', 'contact_person': 'Robert Smith', 'email': 'robert.smith@qualityretailllc.com', 'phone': '+1-860-367-3372', 'address': '1316 Main St, Suite 189', 'city': 'New York', 'state': 'Florida', 'zip_code': '74889', 'contract_start_date': datetime.datetime(2011, 5, 21, 0, 0), 'source_system': 'Synthetic Data', 'load_timestamp': datetime.datetime(2025, 5, 27, 22, 11, 37, 588532)}, {'supplier_id': '7a6a7079-14e2-4d5e-b1d0-ca7b36951aec', 'supplier_name': 'Premier Supply Inc', 'contact_person': 'Sarah Williams', 'email': 'sarah.williams@premiersupplyinc.com', 'phone': '+1-833-905-1541', 'address': '1552 Main St, Suite 445', 'city': 'Philadelphia', 'state': 'Illinois', 'zip_code': '43501', 'contract_start_date': datetime.datetime(2011, 3, 7, 0, 0), 'source_system': 'Synthetic Data', 'load_timestamp': datetime.datetime(2025, 5, 27, 22, 11, 37, 588548)}, {'supplier_id': 'c2e329f7-39dd-48e5-aa59-ba79d92ecbbf', 'supplier_name': 'Quality Goods Inc', 'contact_person': 'Lisa Miller', 'email': 'lisa.miller@qualitygoodsinc.com', 'phone': '+1-342-567-7476', 'address': '2015 Main St, Suite 977', 'city': 'San Antonio', 'state': 'Florida', 'zip_code': '76632', 'contract_start_date': datetime.datetime(2011, 3, 21, 0, 0), 'source_system': 'Synthetic Data', 'load_timestamp': datetime.datetime(2025, 5, 27, 22, 11, 37, 588558)}, {'supplier_id': '9840c064-8b9d-4186-87ed-1fc04626cac7', 'supplier_name': 'Mega Trading Group', 'contact_person': 'John Jones', 'email': 'john.jones@megatradinggroup.com', 'phone': '+1-718-520-4075', 'address': '4892 Main St, Suite 564', 'city': 'San Antonio', 'state': 'Florida', 'zip_code': '89562', 'contract_start_date': datetime.datetime(2010, 4, 16, 0, 0), 'source_system': 'Synthetic Data', 'load_timestamp': datetime.datetime(2025, 5, 27, 22, 11, 37, 588568)}, {'supplier_id': '5e733db7-aabe-4e81-9a3f-6835d1e90553', 'supplier_name': 'Quality Distribution Industries', 'contact_person': 'Mike Brown', 'email': 'mike.brown@qualitydistributionindustries.com', 'phone': '+1-202-153-4728', 'address': '6583 Main St, Suite 801', 'city': 'San Diego', 'state': 'California', 'zip_code': '76267', 'contract_start_date': datetime.datetime(2011, 5, 13, 0, 0), 'source_system': 'Synthetic Data', 'load_timestamp': datetime.datetime(2025, 5, 27, 22, 11, 37, 588577)}, {'supplier_id': 'b161a90c-3dd4-4def-8cfb-30dc5c5797bb', 'supplier_name': 'Premier Merchandise LLC', 'contact_person': 'Emily Brown', 'email': 'emily.brown@premiermerchandisellc.com', 'phone': '+1-575-630-3333', 'address': '5936 Main St, Suite 290', 'city': 'Phoenix', 'state': 'Ohio', 'zip_code': '18262', 'contract_start_date': datetime.datetime(2012, 9, 26, 0, 0), 'source_system': 'Synthetic Data', 'load_timestamp': datetime.datetime(2025, 5, 27, 22, 11, 37, 588587)}  ... displaying 10 of 50 total bound parameter sets ...  {'supplier_id': '658d9ebb-7f86-4752-837a-df65ca703b94', 'supplier_name': 'Ultra Goods LLC', 'contact_person': 'John Jones', 'email': 'john.jones@ultragoodsllc.com', 'phone': '+1-922-552-8478', 'address': '3283 Main St, Suite 238', 'city': 'Los Angeles', 'state': 'Michigan', 'zip_code': '76545', 'contract_start_date': datetime.datetime(2010, 3, 28, 0, 0), 'source_system': 'Synthetic Data', 'load_timestamp': datetime.datetime(2025, 5, 27, 22, 11, 37, 588997)}, {'supplier_id': 'ff7be69c-ec2a-477d-8378-7abec21cfd05', 'supplier_name': 'National Retail Partners', 'contact_person': 'Jane Brown', 'email': 'jane.brown@nationalretailpartners.com', 'phone': '+1-982-118-9767', 'address': '9115 Main St, Suite 396', 'city': 'Los Angeles', 'state': 'North Carolina', 'zip_code': '80245', 'contract_start_date': datetime.datetime(2010, 1, 29, 0, 0), 'source_system': 'Synthetic Data', 'load_timestamp': datetime.datetime(2025, 5, 27, 22, 11, 37, 589010)})]
(Background on this error at: https://sqlalche.me/e/14/9h9h)
[2025-05-27T22:11:37.642+0000] {taskinstance.py:1400} INFO - Marking task as UP_FOR_RETRY. dag_id=synthetic_data_generation, task_id=generate_supplier_data, execution_date=20250527T221135, start_date=20250527T221137, end_date=20250527T221137
[2025-05-27T22:11:37.657+0000] {standard_task_runner.py:104} ERROR - Failed to execute job 438 for task generate_supplier_data ((psycopg2.errors.StringDataRightTruncation) value too long for type character varying(20)

[SQL: INSERT INTO ods_supplier (supplier_id, supplier_name, contact_person, email, phone, address, city, state, zip_code, contract_start_date, source_system, load_timestamp) VALUES (%(supplier_id)s, %(supplier_name)s, %(contact_person)s, %(email)s, %(phone)s, %(address)s, %(city)s, %(state)s, %(zip_code)s, %(contract_start_date)s, %(source_system)s, %(load_timestamp)s)]
[parameters: ({'supplier_id': '24a17ebd-a799-41c6-9a97-a3b8b7b7c4a7', 'supplier_name': 'Premier Products Corp', 'contact_person': 'Mike Jones', 'email': 'mike.jones@premierproductscorp.com', 'phone': '+1-815-876-4999', 'address': '8322 Main St, Suite 536', 'city': 'Phoenix', 'state': 'Florida', 'zip_code': '85784', 'contract_start_date': datetime.datetime(2012, 3, 25, 0, 0), 'source_system': 'Synthetic Data', 'load_timestamp': datetime.datetime(2025, 5, 27, 22, 11, 37, 588482)}, {'supplier_id': 'e2d5ce8e-525c-4af8-a5cb-b106d77eb45f', 'supplier_name': 'Global Logistics Enterprises', 'contact_person': 'Mike Smith', 'email': 'mike.smith@globallogisticsenterprises.com', 'phone': '+1-325-777-4233', 'address': '2200 Main St, Suite 969', 'city': 'San Diego', 'state': 'Ohio', 'zip_code': '45585', 'contract_start_date': datetime.datetime(2010, 1, 8, 0, 0), 'source_system': 'Synthetic Data', 'load_timestamp': datetime.datetime(2025, 5, 27, 22, 11, 37, 588520)}, {'supplier_id': '38fad1dd-67e0-4cb1-b408-ab103fb25da2', 'supplier_name': 'Quality Retail LLC', 'contact_person': 'Robert Smith', 'email': 'robert.smith@qualityretailllc.com', 'phone': '+1-860-367-3372', 'address': '1316 Main St, Suite 189', 'city': 'New York', 'state': 'Florida', 'zip_code': '74889', 'contract_start_date': datetime.datetime(2011, 5, 21, 0, 0), 'source_system': 'Synthetic Data', 'load_timestamp': datetime.datetime(2025, 5, 27, 22, 11, 37, 588532)}, {'supplier_id': '7a6a7079-14e2-4d5e-b1d0-ca7b36951aec', 'supplier_name': 'Premier Supply Inc', 'contact_person': 'Sarah Williams', 'email': 'sarah.williams@premiersupplyinc.com', 'phone': '+1-833-905-1541', 'address': '1552 Main St, Suite 445', 'city': 'Philadelphia', 'state': 'Illinois', 'zip_code': '43501', 'contract_start_date': datetime.datetime(2011, 3, 7, 0, 0), 'source_system': 'Synthetic Data', 'load_timestamp': datetime.datetime(2025, 5, 27, 22, 11, 37, 588548)}, {'supplier_id': 'c2e329f7-39dd-48e5-aa59-ba79d92ecbbf', 'supplier_name': 'Quality Goods Inc', 'contact_person': 'Lisa Miller', 'email': 'lisa.miller@qualitygoodsinc.com', 'phone': '+1-342-567-7476', 'address': '2015 Main St, Suite 977', 'city': 'San Antonio', 'state': 'Florida', 'zip_code': '76632', 'contract_start_date': datetime.datetime(2011, 3, 21, 0, 0), 'source_system': 'Synthetic Data', 'load_timestamp': datetime.datetime(2025, 5, 27, 22, 11, 37, 588558)}, {'supplier_id': '9840c064-8b9d-4186-87ed-1fc04626cac7', 'supplier_name': 'Mega Trading Group', 'contact_person': 'John Jones', 'email': 'john.jones@megatradinggroup.com', 'phone': '+1-718-520-4075', 'address': '4892 Main St, Suite 564', 'city': 'San Antonio', 'state': 'Florida', 'zip_code': '89562', 'contract_start_date': datetime.datetime(2010, 4, 16, 0, 0), 'source_system': 'Synthetic Data', 'load_timestamp': datetime.datetime(2025, 5, 27, 22, 11, 37, 588568)}, {'supplier_id': '5e733db7-aabe-4e81-9a3f-6835d1e90553', 'supplier_name': 'Quality Distribution Industries', 'contact_person': 'Mike Brown', 'email': 'mike.brown@qualitydistributionindustries.com', 'phone': '+1-202-153-4728', 'address': '6583 Main St, Suite 801', 'city': 'San Diego', 'state': 'California', 'zip_code': '76267', 'contract_start_date': datetime.datetime(2011, 5, 13, 0, 0), 'source_system': 'Synthetic Data', 'load_timestamp': datetime.datetime(2025, 5, 27, 22, 11, 37, 588577)}, {'supplier_id': 'b161a90c-3dd4-4def-8cfb-30dc5c5797bb', 'supplier_name': 'Premier Merchandise LLC', 'contact_person': 'Emily Brown', 'email': 'emily.brown@premiermerchandisellc.com', 'phone': '+1-575-630-3333', 'address': '5936 Main St, Suite 290', 'city': 'Phoenix', 'state': 'Ohio', 'zip_code': '18262', 'contract_start_date': datetime.datetime(2012, 9, 26, 0, 0), 'source_system': 'Synthetic Data', 'load_timestamp': datetime.datetime(2025, 5, 27, 22, 11, 37, 588587)}  ... displaying 10 of 50 total bound parameter sets ...  {'supplier_id': '658d9ebb-7f86-4752-837a-df65ca703b94', 'supplier_name': 'Ultra Goods LLC', 'contact_person': 'John Jones', 'email': 'john.jones@ultragoodsllc.com', 'phone': '+1-922-552-8478', 'address': '3283 Main St, Suite 238', 'city': 'Los Angeles', 'state': 'Michigan', 'zip_code': '76545', 'contract_start_date': datetime.datetime(2010, 3, 28, 0, 0), 'source_system': 'Synthetic Data', 'load_timestamp': datetime.datetime(2025, 5, 27, 22, 11, 37, 588997)}, {'supplier_id': 'ff7be69c-ec2a-477d-8378-7abec21cfd05', 'supplier_name': 'National Retail Partners', 'contact_person': 'Jane Brown', 'email': 'jane.brown@nationalretailpartners.com', 'phone': '+1-982-118-9767', 'address': '9115 Main St, Suite 396', 'city': 'Los Angeles', 'state': 'North Carolina', 'zip_code': '80245', 'contract_start_date': datetime.datetime(2010, 1, 29, 0, 0), 'source_system': 'Synthetic Data', 'load_timestamp': datetime.datetime(2025, 5, 27, 22, 11, 37, 589010)})]
(Background on this error at: https://sqlalche.me/e/14/9h9h); 134)
[2025-05-27T22:11:37.711+0000] {local_task_job_runner.py:228} INFO - Task exited with return code 1
[2025-05-27T22:11:37.771+0000] {taskinstance.py:2778} INFO - 0 downstream tasks scheduled from follow-on schedule check
